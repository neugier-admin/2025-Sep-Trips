<!DOCTYPE html>
<html lang="zh-Hant" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÊàëÁöÑÂ§ßÈò™‰πãÊóÖ 2025</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- 
      ÁâàÊú¨Ë™™Êòé: v5.5 (Title Update)
      - Ë°åÁ®ãÊ®ôÈ°åÊõ¥Êñ∞: Ê†πÊìö‰ΩøÁî®ËÄÖÁöÑË¶ÅÊ±ÇÔºåÂ∞áÊØèÊó•Ë°åÁ®ãÁöÑ‰∏ªÈ°åÊõ¥Êñ∞ÁÇ∫Êõ¥Á∞°ÊΩî„ÄÅÁõ¥ËßÄÁöÑÊèèËø∞„ÄÇ
      - AI Âª∫Ë≠∞Êô∫ÊÖßÂçáÁ¥ö: AI ÊúÉÊ†πÊìöÁï∂Êó•Ë°åÁ®ãÂú∞ÈªûÊèê‰æõÂª∫Ë≠∞Ôºå‰∏¶ÈÅøÂÖçÊé®Ëñ¶ÈáçË§áÁöÑÈ§êÂª≥„ÄÇ
      - Â§©Ê∞£Ë≥áË®äÁ¢∫Ë™ç: Á¢∫‰øù‰ºäË≥ÄÂíå‰ºäÂã¢ÁöÑÂ§©Ê∞£Ë≥áÊñôË¢´Á¥çÂÖ•Êì∑ÂèñÁØÑÂúç„ÄÇ
    -->
    <!-- üé® PART 1: STYLES (CSS) -->
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        .timeline-item::before {
            content: '';
            position: absolute;
            left: 1.25rem;
            top: 1.75rem;
            bottom: -1.75rem;
            width: 2px;
            background-color: #4b5563;
        }
        .timeline-item:last-child::before {
            display: none;
        }
        .page {
            transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .page-hidden {
            transform: translateX(100%);
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .loader-small {
            border: 2px solid #374151;
            border-top: 2px solid #60a5fa;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
        }
        .gemini-loader {
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-top: 4px solid #4f46e5;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        .hide-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        .hide-scrollbar::-webkit-scrollbar {
            display: none;
        }
    </style>
</head>
<body class="bg-gray-900 text-gray-200">

    <!-- üèõÔ∏è PART 2: APPLICATION STRUCTURE (HTML) -->
    <div id="app-container" class="relative h-screen w-full max-w-lg mx-auto bg-gray-800 overflow-hidden shadow-2xl flex flex-col">
        <div id="main-page-wrapper" class="flex flex-col flex-grow h-full">
            <header class="flex-shrink-0 bg-gray-800/80 backdrop-blur-sm z-20 px-4 sm:px-6 py-4 border-b border-gray-700 flex items-center justify-center relative">
                <h1 id="main-title" class="text-2xl font-bold text-gray-100"></h1>
            </header>
            <main class="flex-grow overflow-y-auto p-6 hide-scrollbar">
                <section id="itinerary-view" class="space-y-4"></section>
                
                <section id="foodie-view" class="hidden space-y-6">
                    <!-- AIÂª∫Ë≠∞ÂçÄÂ°äÁöÑÈùúÊÖãÈ™®Êû∂ -->
                    <div id="ai-foodie-container">
                        <button id="get-ai-suggestions" class="w-full flex items-center justify-center gap-2 px-4 py-3 bg-indigo-600 text-white font-bold rounded-lg hover:bg-indigo-700 transition-colors shadow-lg">
                            <!-- SVG Icon will be inserted by JS -->
                             ‚ú® AI ÁæéÈ£üÂª∫Ë≠∞
                        </button>
                        <div id="ai-suggestions-loader" class="hidden mt-4 flex justify-center"><div class="gemini-loader"></div></div>
                        <div id="ai-suggestions-error" class="hidden mt-4 text-red-500 text-center"></div>
                        <div id="ai-suggestions-results" class="space-y-3 mt-4"></div>
                    </div>
                    <!-- ÁæéÈ£üÊ∏ÖÂñÆÁöÑÂÆπÂô®ÔºåJSÊúÉÂ∞áÂàÜÈ°ûÂæåÁöÑÂÖßÂÆπÂ°´ÂÖ•Ê≠§Ëôï -->
                    <div id="foodie-list-container" class="space-y-6"></div>
                </section>

                <section id="coupon-view" class="hidden space-y-6">
                     <!-- ÂÑ™ÊÉ†Âà∏Âç°ÁâáÁöÑÂÆπÂô®ÔºåJSÊúÉÂ∞áÂàÜÈ°ûÂæåÁöÑÂÖßÂÆπÂ°´ÂÖ•Ê≠§Ëôï -->
                    <div id="coupon-list-container" class="space-y-6"></div>
                    <!-- Ë≥áÊñô‰æÜÊ∫êÈÄ£ÁµêÁöÑÈùúÊÖãÈ™®Êû∂ -->
                    <div class="md:col-span-2 text-center text-xs text-gray-500 mt-6">
                        source from : <a href="https://www.funtime.com.tw/blog/funtime/japan-coupon" target="_blank" rel="noopener noreferrer" class="underline hover:text-gray-400">https://www.funtime.com.tw/blog/funtime/japan-coupon</a>
                    </div>
                </section>
            </main>
            <nav class="flex-shrink-0 bg-gray-800/90 backdrop-blur-sm border-t border-gray-700 z-20">
                <div id="nav-container" class="flex justify-around"></div>
            </nav>
        </div>
        <div id="detail-page" class="page page-hidden absolute inset-0 bg-gray-800 z-30 flex flex-col">
            <header id="detail-header" class="flex-shrink-0 bg-gray-800/80 backdrop-blur-sm z-10 px-4 py-4 border-b border-gray-700 flex items-center"></header>
            <div id="detail-content" class="flex-grow overflow-y-auto hide-scrollbar"></div>
        </div>
        <div id="coupon-modal" class="fixed inset-0 bg-black bg-opacity-75 z-40 flex items-center justify-center p-4 hidden">
            <div id="coupon-modal-content" class="relative bg-gray-800 rounded-lg max-w-lg w-full"></div>
        </div>
    </div>

    <!-- üñºÔ∏è PART 3: HTML TEMPLATES -->
    <template id="template-itinerary-card">
        <div class="bg-gray-700/50 p-5 rounded-xl shadow-sm hover:shadow-md hover:bg-gray-700 transition-all cursor-pointer">
            <div class="flex justify-between items-start">
                <div class="flex-grow">
                    <div class="flex items-baseline gap-2">
                        <p class="text-sm font-semibold text-blue-400" data-text="day"></p>
                        <p class="text-xs text-gray-400" data-text="date"></p>
                        <div class="note-icon-container"></div>
                    </div>
                    <h3 class="text-lg font-bold text-gray-100 mt-1" data-text="theme"></h3>
                </div>
                <div class="weather-container w-12 h-10 flex items-center justify-center">
                    <div class="loader-small"></div>
                </div>
            </div>
        </div>
    </template>
    <template id="template-foodie-card">
        <div class="flex items-center justify-between bg-gray-800 p-4 rounded-xl border border-gray-700 shadow-sm">
            <div class="flex-grow pr-4">
                <div class="flex items-baseline gap-3 flex-wrap">
                    <h4 class="font-bold text-gray-200 text-lg" data-text="name"></h4>
                    <span class="text-xs font-semibold inline-block py-1 px-2 uppercase rounded-full text-blue-200 bg-blue-900" data-text="tag"></span>
                    <span class="ai-badge text-xs font-bold text-indigo-300 bg-indigo-900 px-2 py-0.5 rounded-full hidden">AI</span>
                </div>
            </div>
            <a href="#" target="_blank" class="map-link flex-shrink-0 w-12 h-12 flex items-center justify-center rounded-full bg-gray-700 hover:bg-gray-600 transition-colors"></a>
        </div>
    </template>
    <template id="template-coupon-card">
        <div class="bg-gray-700/50 border border-gray-700 rounded-xl overflow-hidden shadow-sm flex flex-col cursor-pointer coupon-card">
            <div class="p-4 flex-grow flex flex-col pointer-events-none">
                <h3 class="font-bold text-lg text-gray-200" data-text="name"></h3>
                <p class="text-sm text-gray-400 mt-1 flex-grow" data-text="discount"></p>
                <div class="flex justify-between items-center text-xs text-gray-500 mt-2">
                    <div class="flex items-center gap-2">
                        <span>ÊúâÊïàÊúüÈôê: <span data-text="expiry"></span></span>
                        <span class="region-tag text-xs bg-green-900 text-green-200 px-2 py-0.5 rounded-full hidden" data-text="region"></span>
                    </div>
                    <div class="link-icon-container"></div>
                </div>
            </div>
        </div>
    </template>
    <template id="template-timeline-item">
        <div class="timeline-item relative pl-10 pb-14">
            <div class="absolute left-0 flex items-center justify-center w-10 h-10">
                <div class="w-4 h-4 bg-blue-500 rounded-full border-4 border-gray-800"></div>
            </div>
            <p class="text-sm font-semibold text-gray-400 mb-1" data-text="time"></p>
            <h4 class="font-bold text-lg text-gray-100" data-text="title"></h4>
            <p class="text-gray-300 mt-1 mb-3" data-text="description"></p>
            <a href="#" target="_blank" class="transport-link inline-flex items-center gap-2 text-sm text-blue-300 bg-blue-900/30 p-2 rounded-lg hover:bg-blue-900/50">
                <span data-text="transport"></span>
            </a>
        </div>
    </template>
    <template id="template-optional-activity">
         <a href="#" target="_blank" class="optional-activity-link flex items-center gap-4 bg-gray-700/50 p-4 rounded-lg hover:bg-gray-700">
            <div class="flex-grow">
                <h5 class="font-bold text-gray-200" data-text="title"></h5>
                <p class="text-sm text-gray-400 mt-1" data-text="description"></p>
            </div>
        </a>
    </template>

    <!-- ‚ö° PART 4: DATA & LOGIC (JAVASCRIPT) -->
    <script>
        // üìö 4.1: CONFIG & DATA LIBRARIES
        const config = {
            api: {
                weather: {
                    forecast: "https://api.open-meteo.com/v1/forecast",
                    archive: "https://archive-api.open-meteo.com/v1/archive"
                },
                gemini: {
                    url: "https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent",
                    apiKey: ""
                }
            },
            categories: {
                coupons: {
                    order: ["ÈõªÂô®", "Ëó•Â¶ù", "ÁôæË≤®", "Á∂úÂêà/ÂÖçÁ®Ö", "ÂÖ∂‰ªñ"],
                    icons: { "ÈõªÂô®": "plug-zap", "Ëó•Â¶ù": "pilcrow", "ÁôæË≤®": "shopping-bag", "Á∂úÂêà/ÂÖçÁ®Ö": "gem", "ÂÖ∂‰ªñ": "shopping-cart" }
                },
                foodie: {
                    regionOrder: ['Èõ£Ê≥¢', 'Ê¢ÖÁî∞', '‰∫¨ÈÉΩ', 'ÂêçÂè§Â±ã']
                }
            },
            simulationDate: '2025-07-20T14:56:00+09:00'
        };

        const tripData = {
            "tripTitle": "Â§ßÈò™ 2025",
            "locations": { "Osaka": { "lat": 34.69, "lon": 135.50 }, "Kishiwada": { "lat": 34.46, "lon": 135.37 }, "Kyoto": { "lat": 35.01, "lon": 135.76 }, "Ise": { "lat": 34.49, "lon": 136.71 }, "Iga": { "lat": 34.77, "lon": 136.13 }, "Nagoya": { "lat": 35.18, "lon": 136.91 } },
            "itinerary": [
                { "day": 1, "date": "2025-09-13", "theme": "Â≤∏ÂíåÁî∞Á•≠ÂÖ∏", "location": "Kishiwada", "activities": [ { "time": "Áï∂Êó•‰ΩèÂÆø", "title": "ROZY HOTEL NAMBA", "description": "ÊóÖÁ®ãÁ¨¨‰∏Ä„ÄÅ‰∫åÊó•ÁöÑ‰∏ãÊ¶ªÈÖíÂ∫ó„ÄÇ", "transport": "‰ΩçÊñºÈõ£Ê≥¢Âú∞ÂçÄÔºå‰∫§ÈÄö‰æøÂà©„ÄÇ", "mapLink": "https://www.google.com/maps/search/?api=1&query=ROZY+HOTEL+NAMBA" }, { "time": "05:50", "title": "ÊäµÈÅîÈóúË•øÊ©üÂ†¥ (MM068)", "description": "Ëà™Áè≠ MM068 ÂæûÈ¶ôÊ∏ØÊäµÈÅî„ÄÇËæ¶ÁêÜÂÖ•Â¢ÉÊâãÁ∫å„ÄÅÈ†òÂèñË°åÊùéÔºåÊ∫ñÂÇôÈñãÂßãÊóÖÁ®ãÔºÅ", "transport": "ÂæûÈóúË•øÊ©üÂ†¥ (KIX) Êê≠‰πòÂçóÊµ∑ÈõªÈêµ (Nankai Railway) ÂâçÂæÄ„ÄéÂçóÊµ∑Èõ£Ê≥¢Á´ô„Äè(Á¥Ñ45ÂàÜÈêò)„ÄÇ", "mapLink": "https://www.google.com/maps/search/?api=1&query=Kansai+International+Airport" }, { "time": "‰∏äÂçà", "title": "ÂâçÂæÄÈÖíÂ∫ó & Check-in", "description": "ÂâçÂæÄ ROZY HOTEL NAMBA Ëæ¶ÁêÜÂÖ•‰ΩèÊàñÂØÑÂ≠òË°åÊùé„ÄÇ", "transport": "Âæû„ÄéÂçóÊµ∑Èõ£Ê≥¢Á´ô„ÄèÊ≠•Ë°åÊàñÁü≠Á®ã‰∫§ÈÄöËá≥ÈÖíÂ∫ó„ÄÇ", "mapLink": "https://www.google.com/maps/search/?api=1&query=ROZY+HOTEL+NAMBA" }, { "time": "‰∏≠Âçà", "title": "Êó•Êú¨Ê©ãÂãïÊº´Êé¢Èö™", "description": "ÈÖíÂ∫óÂÆâÈ†ìÂ•ΩÂæåÔºåÊ≠•Ë°åÂâçÂæÄË¢´Á®±ÁÇ∫„ÄéÈõªÈõªÂüé„ÄèÁöÑÊó•Êú¨Ê©ã„ÄÇÈÄôË£°ÁöÑÂ∫óËàñÁ¥ÑÂú®11ÈªûÂæåÈô∏Á∫åÈñãÈñÄÔºåÊòØÂãïÊº´Ëø∑ÂíåÈõªÁé©Ëø∑ÁöÑÂ§©Â†Ç„ÄÇ", "transport": "ÂæûÈõ£Ê≥¢ÈÖíÂ∫óÊ≠•Ë°åÂâçÂæÄ (Á¥Ñ10-15ÂàÜÈêò)„ÄÇ", "mapLink": "https://www.google.com/maps/search/?api=1&query=Nipponbashi+Den+Den+Town" }, { "time": "‰∏ãÂçà (Á¥Ñ 14:00 Âæå)", "title": "Â≤∏ÂíåÁî∞„Å†„Çì„Åò„ÇäÁ•≠ (ÂçàÂæåÊõ≥Ë°å)", "description": "ÂâçÂæÄÂ≤∏ÂíåÁî∞ÊÑüÂèóÁ•≠ÂÖ∏ÊúÄÂà∫ÊøÄÁöÑ„ÄéÂçàÂæåÊõ≥Ë°å„Äè„ÄÇÊúÄ‰Ω≥ËßÄË≥ûÂú∞ÈªûÊòØ„Äé„Ç´„É≥„Ç´„É≥Â†¥„ÄèÂçÅÂ≠óË∑ØÂè£ÔºåÈ´îÈ©óÂú∞ËªäÈ´òÈÄüÈÅéÂΩéÁöÑÈúáÊíºÂäõ„ÄÇ", "transport": "Âæû„ÄéÂçóÊµ∑Èõ£Ê≥¢Á´ô„ÄèÊê≠‰πòÂçóÊµ∑Êú¨Á∑öÂâçÂæÄ„ÄéÂ≤∏ÂíåÁî∞Á´ô„Äè(Á¥Ñ30ÂàÜÈêò)„ÄÇ", "mapLink": "https://www.google.com/maps/search/?api=1&query=Kishiwada+Kankanba" }, { "time": "ÂÇçÊôö (ÊôöÈ§êÊôÇÈñì)", "title": "Á•≠ÂÖ∏Â±ãÂè∞ÁæéÈ£üÈ´îÈ©ó", "description": "Âú®‰∏ãÂçàËàáÂ§úÊôöÂ∑°ÈÅäÁöÑÁ©∫Ê™îÔºåÊñºÁ•≠ÂÖ∏ÁöÑÂ±ãÂè∞(Â∞èÈ£üÊî§)Ëß£Ê±∫ÊôöÈ§êÔºåÂìÅÂöêÁ´†È≠öÁáí„ÄÅÁÇíÈ∫µÁ≠âÂú∞ÈÅìÁ•≠ÂÖ∏ÁæéÈ£ü„ÄÇ", "transport": "Á•≠ÂÖ∏ÊúÉÂ†¥Âë®ÈÇä", "mapLink": "https://www.google.com/maps/search/?api=1&query=Kishiwada+Kankanba" }, { "time": "Â§úÊôö (19:00 Âæå)", "title": "ÁÅØÂÖ•„ÇåÊõ≥Ë°å (ÁáàÁ±†Â∑°ÈÅä)", "description": "Ê¨£Ë≥ûËàáÁôΩÂ§©Êà™ÁÑ∂‰∏çÂêåÁöÑÂ§¢ÂπªÊôØË±°„ÄÇÊé®Ëñ¶Âú®„ÄéÂ≤∏ÂíåÁî∞ÂüéÂë®Ëæ∫„ÄèÊàñ„ÄéÂ≤∏ÂíåÁî∞ÈßÖÂâçÈÄöÂïÜÂ∫óË°ó„ÄèËßÄË≥ûÔºåÊÑüÂèóÊéõÊªøÁáàÁ±†ÁöÑÂú∞ËªäÂú®Â§úËâ≤‰∏≠Á∑©ÊÖ¢Â∑°ÈÅäÁöÑÂÑ™ÈõÖËàáÊ∫´È¶®Ê∞£Ê∞õ„ÄÇ", "transport": "Âæû„ÄéÂ≤∏ÂíåÁî∞Á´ô„ÄèÊê≠‰πòÂçóÊµ∑Êú¨Á∑öËøîÂõû„ÄéÂçóÊµ∑Èõ£Ê≥¢Á´ô„Äè(Á¥Ñ30ÂàÜÈêò)„ÄÇ", "mapLink": "https://www.google.com/maps/search/?api=1&query=Kishiwada+Castle" } ] },
                { "day": 2, "date": "2025-09-14", "theme": "ONE OK ROCK ÊºîÂî±ÊúÉ", "location": "Osaka", "activities": [ { "time": "Áï∂Êó•‰ΩèÂÆø", "title": "ROZY HOTEL NAMBA", "description": "ÊóÖÁ®ãÁ¨¨‰∏Ä„ÄÅ‰∫åÊó•ÁöÑ‰∏ãÊ¶ªÈÖíÂ∫ó„ÄÇ", "transport": "‰ΩçÊñºÈõ£Ê≥¢Âú∞ÂçÄÔºå‰∫§ÈÄö‰æøÂà©„ÄÇ", "mapLink": "https://www.google.com/maps/search/?api=1&query=ROZY+HOTEL+NAMBA" }, { "time": "‰∏äÂçà", "title": "ÂøÉÈΩãÊ©ã PARCO Ë≥ºÁâ©", "description": "ÂæûÈõ£Ê≥¢ÂâçÂæÄÂøÉÈΩãÊ©ãÔºåÁõ¥ÈÅî PARCO ÁôæË≤®„ÄÇÈÄôË£°ÈõÜÁµê‰∫ÜÊΩÆÊµÅ„ÄÅÂãïÊº´„ÄÅËóùË°ìÔºåÂèØ‰ª•Áõ¥Ë°ù6Ê®ìÁöÑCAPCOM STORE„ÄÇ", "transport": "Âæû Osaka Metro„ÄéÈõ£Ê≥¢Á´ô„ÄèÊê≠‰πòÂæ°Â†ÇÁ≠ãÁ∑öÂâçÂæÄ„ÄéÂøÉÈΩãÊ©ãÁ´ô„Äè(Á¥Ñ2ÂàÜÈêò)„ÄÇ", "mapLink": "https://www.google.com/maps/search/?api=1&query=Shinsaibashi+PARCO" }, { "time": "‰∏ãÂçà", "title": "ÊèêÊó©ÂâçÂæÄÈï∑Â±Ö & Ë≥ºË≤∑Âë®ÈÇäÂïÜÂìÅ", "description": "ÊèêÊó©ÂâçÂæÄÈï∑Â±ÖÂÖ¨ÂúíÔºåÊÑüÂèóÊºîÂî±ÊúÉÊ∞£Ê∞õ‰∏¶ÊéíÈöäË≥ºË≤∑ÂÆòÊñπÂë®ÈÇäÂïÜÂìÅ (Goods)„ÄÇ", "transport": "Âæû Osaka Metro„ÄéÂøÉÈΩãÊ©ãÁ´ô„ÄèÊê≠‰πòÂæ°Â†ÇÁ≠ãÁ∑öÂâçÂæÄ„ÄéÈï∑Â±ÖÁ´ô„Äè(Á¥Ñ15ÂàÜÈêò)„ÄÇ", "mapLink": "https://www.google.com/maps/search/?api=1&query=Yanmar+Stadium+Nagai" }, { "time": "17:30", "title": "ONE OK ROCK 2025 TOUR \"DETOX\"", "description": "17:30ÈñãÊºî„ÄÇÊ∫ñÂÇôÂÖ•Â†¥Ôºå‰∫´Âèó‰∏ÄÂ†¥ÁÜ±Ë°ÄÊ≤∏È®∞ÁöÑÊêñÊªæÊºîÂî±ÊúÉÔºÅ", "transport": "Âæû Osaka Metro„ÄéÈõ£Ê≥¢Á´ô„ÄèÊê≠‰πòÂæ°Â†ÇÁ≠ãÁ∑ö (Midosuji Line) ÂâçÂæÄ„ÄéÈï∑Â±ÖÁ´ô„Äè„ÄÇ", "mapLink": "https://www.google.com/maps/search/?api=1&query=Yanmar+Stadium+Nagai" } ], "optionalActivities": [ { "title": "teamLab Botanical Garden (Â§úÈñì)", "description": "ÊºîÂî±ÊúÉÂæåÂèØËÄÉÊÖÆÂâçÂæÄ„ÄÇÂ†¥È§®Âú®Èï∑Â±ÖÂÖ¨ÂúíÂÖßÔºåÊ≠•Ë°åÂèØÈÅî„ÄÇÊúÄÂæåÂÖ•Â†¥ÊôÇÈñìÁÇ∫ 21:30ÔºåÊôÇÈñìÊúÉÈùûÂ∏∏Á∑äÊπäÔºåË´ãËá™Ë°åÊñüÈÖå„ÄÇ", "mapLink": "https://www.google.com/maps/search/?api=1&query=teamLab+Botanical+Garden+Osaka" } ] },
                { "day": 3, "date": "2025-09-15", "theme": "ÈÖíÂ∫óËΩâÁßª & Ë≥ºÁâ©Êó•", "location": "Osaka", "activities": [ { "time": "‰∏äÂçà / ‰ΩèÂÆø", "title": "ÂÖ•‰Ωè: Êù±Ê©´INN Â§ßÈò™Ê¢ÖÁî∞Êù±", "description": "ÂæûÈõ£Ê≥¢ÈÖíÂ∫óÈÄÄÊàøÔºåÂâçÂæÄÊ¢ÖÁî∞Êñ∞ÈÖíÂ∫óËæ¶ÁêÜÂÖ•‰Ωè‰∏¶ÂØÑÂ≠òË°åÊùé„ÄÇ", "transport": "Âæû Osaka Metro„ÄéÈõ£Ê≥¢Á´ô„ÄèÊê≠‰πòÂæ°Â†ÇÁ≠ãÁ∑öÂà∞„ÄéÊ¢ÖÁî∞Á´ô„ÄèÔºåÂÜçËΩâ‰πòË∞∑Áî∫Á∑öÂà∞„ÄéÊù±Ê¢ÖÁî∞Á´ô„ÄèÂæåÊ≠•Ë°å (Á∏ΩÁ®ãÁ¥Ñ20ÂàÜÈêò)„ÄÇ", "mapLink": "https://www.google.com/maps/search/?api=1&query=Toyoko+Inn+Osaka+Umeda+Higashi" }, { "time": "‰∏ãÂçà", "title": "Ê¢ÖÁî∞Ë≥ºÁâ©Êé¢Á¥¢", "description": "ÂâçÂæÄÊ¢ÖÁî∞Âú∞Ê®ô‰πã‰∏ÄÁöÑ HEP FIVE ÂïÜÂ†¥ÔºåÂèØ‰ª•‰πòÂùêÁ¥ÖËâ≤Êë©Â§©Ëº™„ÄÇ‰πãÂæåÂú®Èò™ÊÄ•ÁôæË≤®„ÄÅÂ§ß‰∏∏Ê¢ÖÁî∞Â∫óÁ≠âÂ§ßÂûãÁôæË≤®ÂÖ¨Âè∏ÈÄõË°ó„ÄÇ", "transport": "ÂæûÈÖíÂ∫óÊ≠•Ë°åÊàñÊê≠‰πòÂú∞ÈêµËá≥„ÄéÊ¢ÖÁî∞Á´ô„Äè„ÄÇ", "mapLink": "https://www.google.com/maps/search/?api=1&query=HEP+FIVE" }, { "time": "ÂÇçÊôö", "title": "Ê¢ÖÁî∞ÊôöÈ§êËàáÂ§úÊôØ", "description": "Âú®ÈÖíÂ∫ó Check-in ÂæåÔºåÂèØ‰ª•ËÄÉÊÖÆÁôª‰∏äÊ¢ÖÁî∞ËóçÂ§©Â§ßÂªàÁúãÂ§úÊôØÔºå‰∏¶Âú®ÈôÑËøë‰∫´Áî®ÊôöÈ§ê„ÄÇ", "transport": "Ê≠•Ë°åÊàñÁü≠Á®ã‰∫§ÈÄö„ÄÇ", "mapLink": "https://www.google.com/maps/search/?api=1&query=Umeda+Sky+Building" } ], "optionalActivities": [ { "title": "EST („Ç®„Çπ„Éà)", "description": "ÈõÜÁµê‰∫ÜÁúæÂ§öÂπ¥Ëºï‰∫∫ÂñúÊÑõÁöÑÊúçÈ£æÂìÅÁâåÔºåÊòØÂ∞ãÊâæÂπ≥ÂÉπÊΩÆÊµÅÂñÆÂìÅÁöÑÂ•ΩÂéªËôï„ÄÇ", "mapLink": "https://www.google.com/maps/search/?api=1&query=EST+Osaka" }, { "title": "EDION (LINKS UMEDAÂ∫ó)", "description": "Â§ßÂûãÈõªÂô®ÈÄ£ÈéñÂ∫óÔºåËÄ≥Ê©üÈÅ∏Êìá‰πüÂæàÂ§öÔºåÊòØÊ¢ÖÁî∞Âú∞ÂçÄÁöÑÂ•ΩÈÅ∏Êìá„ÄÇ", "mapLink": "https://www.google.com/maps/search/?api=1&query=EDION+LINKS+UMEDA" } ] },
                { "day": 4, "date": "2025-09-16", "theme": "Â§ßÈò™Ëê¨Âçö EXPO 2025", "location": "Osaka", "notes": ["Ê≥®ÊÑèÔºöÈÉ®ÂàÜÁÜ±ÈñÄÂ†¥È§®ÂèØËÉΩÈúÄË¶ÅÈ†êÁ¥ÑÊàñÊäΩÈÅ∏ÔºåË´ãÁïôÊÑèÂÆòÊñπÂÖ¨‰Ωà„ÄÇ"], "activities": [ { "time": "Áï∂Êó•‰ΩèÂÆø", "title": "Êù±Ê©´INN Â§ßÈò™Ê¢ÖÁî∞Êù±", "description": "ÊóÖÁ®ãÁ¨¨‰∏âËá≥ÂçÅÊó•ÁöÑ‰∏ãÊ¶ªÈÖíÂ∫ó„ÄÇ", "transport": "‰ΩçÊñºÊ¢ÖÁî∞Êù±Âú∞ÂçÄÔºåÈÑ∞ËøëÂú∞ÈêµÁ´ô„ÄÇ", "mapLink": "https://www.google.com/maps/search/?api=1&query=Toyoko+Inn+Osaka+Umeda+Higashi" }, { "time": "09:00", "title": "ÊäµÈÅîÂ§¢Ê¥≤ÊúÉÂ†¥", "description": "Ê∫ñÊôÇ‰πùÈªûÂà∞ÈÅîÊúÉÂ†¥ÔºåÊ∫ñÂÇôËøéÊé•Êú™‰æÜÁöÑË°ùÊìäÔºÅ", "transport": "Âª∫Ë≠∞Á¥Ñ 08:00 ÂæûÈÖíÂ∫óÂá∫Áôº„ÄÇÂæû„ÄéÊù±Ê¢ÖÁî∞Á´ô„ÄèÊê≠‰πòË∞∑Áî∫Á∑öÂà∞„ÄéË∞∑Áî∫Âõõ‰∏ÅÁõÆÁ´ô„ÄèÔºåËΩâ‰πò‰∏≠Â§ÆÁ∑öÂâçÂæÄ„ÄéÂ§¢Ê¥≤Á´ô„Äè(Á∏ΩÁ®ãÁ¥Ñ45-60ÂàÜÈêò)„ÄÇ", "mapLink": "https://www.google.com/maps/search/?api=1&query=Yumeshima+Station+Osaka" }, { "time": "‰∏ãÂçà", "title": "Êé¢Á¥¢‰∏ªÈ°åÂ±ïÈ§®", "description": "ÂèÉËßÄÊÑüËààË∂£ÁöÑÂúãÂÆ∂È§®Êàñ‰∏ªÈ°åÈ§®Ôºå‰æãÂ¶Ç„ÄéÊú™‰æÜÁ§æÊúÉÁöÑË©¶È©óÂ†¥„ÄèÔºåÈ´îÈ©óÂ∞ñÁ´ØÁßëÊäÄ„ÄÇ", "transport": "ÂúíÂçÄÂÖßÊ≠•Ë°åÊàñÊê≠‰πòÊé•ÈßÅËªä„ÄÇ", "mapLink": "https://www.google.com/maps/search/?api=1&query=Expo+2025+Osaka" }, { "time": "ÂÇçÊôö", "title": "Â§úÈñìÂÖâÂΩ±ÁßÄËàáËøîÂõû", "description": "Ê¨£Ë≥ûÂúíÂçÄÂ§úÈñìÁöÑÁáàÂÖâËóùË°ìËàáË°®ÊºîÔºå‰πãÂæåÊê≠‰πòÂú∞ÈêµËøîÂõûÊ¢ÖÁî∞„ÄÇ", "transport": "Âæû„ÄéÂ§¢Ê¥≤Á´ô„ÄèÊê≠‰πòÂú∞ÈêµËøîÂõû„ÄéË∞∑Áî∫Âõõ‰∏ÅÁõÆÁ´ô„ÄèÂÜçËΩâ‰πòË∞∑Áî∫Á∑ö (Á∏ΩÁ®ãÁ¥Ñ45-60ÂàÜÈêò)„ÄÇ", "mapLink": "https://www.google.com/maps/search/?api=1&query=Yumeshima+Station+Osaka" } ] },
                { "day": 5, "date": "2025-09-17", "theme": "Êó•Êú¨Áí∞ÁêÉÂΩ±Âüé (USJ)", "location": "Osaka", "notes": ["Ê≥®ÊÑèÔºöÁ¢∫ÂØ¶ÁöÑÊ¥ªÂãïÊôÇÈñìË°®ÔºåË´ãÊñºÂá∫ÁôºÂâç7Êó•Âà∞ÂÆòÁ∂≤Á¢∫Ë™ç„ÄÇ"], "activities": [ { "time": "Áï∂Êó•‰ΩèÂÆø", "title": "Êù±Ê©´INN Â§ßÈò™Ê¢ÖÁî∞Êù±", "description": "ÊóÖÁ®ãÁ¨¨‰∏âËá≥ÂçÅÊó•ÁöÑ‰∏ãÊ¶ªÈÖíÂ∫ó„ÄÇ", "transport": "‰ΩçÊñºÊ¢ÖÁî∞Êù±Âú∞ÂçÄÔºåÈÑ∞ËøëÂú∞ÈêµÁ´ô„ÄÇ", "mapLink": "https://www.google.com/maps/search/?api=1&query=Toyoko+Inn+Osaka+Umeda+Higashi" }, { "time": "Ê∏ÖÊô® (7:00)", "title": "ÊèêÊó©Âá∫ÁôºÔºåÊê∂‰ΩîÂÖàÊ©ü", "description": "È†êË®à7ÈªûÂà∞ÈÅîUSJÈñÄÂè£ÊéíÈöäÔºåÈñãÂúíÂæåÁ¨¨‰∏ÄÊôÇÈñìË°ùÂéªÊéí„ÄéSPY x FAMILY ÁßòÂØÜ‰ªªÂãô 4D„Äè„ÄÇ", "transport": "Âæû„ÄéÊù±Ê¢ÖÁî∞Á´ô„ÄèÊê≠‰πòË∞∑Áî∫Á∑öÂà∞„ÄéÂ§©ÁéãÂØ∫Á´ô„ÄèÔºåËΩâ‰πòJRÂ§ßÈò™Áí∞ÁãÄÁ∑öÂà∞„ÄéË•ø‰πùÊù°Á´ô„ÄèÔºåÂÜçËΩâ‰πòJRÊ´ªÂ≥∂Á∑öÂà∞„ÄéÁí∞ÁêÉÂΩ±ÂüéÁ´ô„Äè(Á∏ΩÁ®ãÁ¥Ñ40ÂàÜÈêò)„ÄÇ", "mapLink": "https://www.google.com/maps/search/?api=1&query=Universal+Studios+Japan" }, { "time": "11:10 - 12:10", "title": "Express Pass: Ë∂ÖÁ¥ö‰ªªÂ§©Â†Ç‰∏ñÁïå‚Ñ¢", "description": "Ê†πÊìöExpress PassÊôÇÈñìÊ∫ñÊôÇÈÄ≤ÂÖ•ÂúíÂçÄÔºÅÂÖàÁé© 11:10-11:40 ÁöÑ„ÄåÁë™Âà©Ê≠êË≥ΩËªä„ÄçÔºåÂÜçÁé© 11:40-12:10 ÁöÑ„ÄåÊ£ÆÂñúÂâõÁöÑÁòãÁãÇÁ∫úËªä„Äç„ÄÇ", "transport": "ÂúíÂçÄÂÖßÊ≠•Ë°å„ÄÇ", "mapLink": "https://www.google.com/maps/search/?api=1&query=Super+Nintendo+World+Japan" }, { "time": "‰∏≠Âçà", "title": "ÂçàÈ§ê & Á∂ìÂÖ∏ÂúíÂçÄ", "description": "Âú®ÂúíÂçÄÂÖß‰∫´Áî®ÂçàÈ§ê„ÄÇÈ§êÂæåÂèØ‰ª•ÂéªÁé©ÊôÇÈñìÂΩàÊÄßÁöÑ„ÄåÂ§ßÁôΩÈØä„ÄçÊàñ„Äå‰æèÈÇèÁ¥ÄÂÖ¨Âúí„Éª‰πòËàπÈÅä„Äç„ÄÇ", "transport": "ÂúíÂçÄÂÖßÊ≠•Ë°å„ÄÇ", "mapLink": "https://www.google.com/maps/search/?api=1&query=Universal+Studios+Japan" }, { "time": "14:40 - 15:30", "title": "Express Pass: ÂìàÂà©Ê≥¢ÁâπÁöÑÈ≠îÊ≥ï‰∏ñÁïå‚Ñ¢", "description": "Ê†πÊìöExpress PassÊôÇÈñìÊ∫ñÊôÇÈÄ≤ÂÖ•ÂúíÂçÄÔºÅÂú® 15:00-15:30 ÊúüÈñìÈ´îÈ©ó„ÄåÂìàÂà©Ê≥¢ÁâπÁ¶ÅÂøå‰πãÊóÖ‚Ñ¢„Äç„ÄÇ", "transport": "Âõ≠ÂçÄÂÖßÊ≠•Ë°å„ÄÇ", "mapLink": "https://www.google.com/maps/search/?api=1&query=The+Wizarding+World+of+Harry+Potter+Osaka" }, { "time": "ÂÇçÊôö (18:00 Âæå)", "title": "Halloween Horror Nights & „Çæ„É≥„Éì„Éª„Éá„Éª„ÉÄ„É≥„Çπ", "description": "ÂÖ•Â§úÂæåÔºåÊ∫ñÂÇôËøéÊé•Ëê¨ËÅñÁØÄÊÅêÊÄñ‰πãÂ§úÔºÅÂú®ÂúíÂçÄÂêÑËôïËàáÂñ™Â±ç‰∏çÊúüËÄåÈÅáÔºå‰∏¶Ê¨£Ë≥ûÁÜ±ÂäõÂõõÂ∞ÑÁöÑ„Äé„Çæ„É≥„Éì„Éª„Éá„Éª„ÉÄ„É≥„Çπ„Äè(Âñ™Â±çÁæ§Ëàû) Ë°®Êºî„ÄÇ", "transport": "ÂúíÂçÄÂÖßÊ≠•Ë°å„ÄÇ", "mapLink": "https://www.google.com/maps/search/?api=1&query=Universal+Studios+Japan" } ], "optionalActivities": [ { "title": "„Éê„Ç§„Ç™„Éè„Ç∂„Éº„Éâ‚Ñ¢ („Éè„É≠„Ç¶„Ç£„Éº„É≥)", "description": "È´îÈ©óËê¨ËÅñÁØÄÊúüÈñìÈôêÂÆöÁöÑÊÅêÊÄñËø∑ÂÆÆÔºåËàáÂñ™Â±çËøëË∑ùÈõ¢Êé•Ëß∏ÔºÅÊ¥ªÂãïÈÄöÂ∏∏Âú®ÂÇçÊôö6ÈªûÂæåÈñãÂßã„ÄÇ", "mapLink": "https://www.google.com/maps/search/?api=1&query=Universal+Studios+Japan" }, { "title": "Ëó•Â±ã„ÅÆ„Å≤„Å®„Çä„Åî„Å® „Éü„Çπ„ÉÜ„É™„Éº„Éª„Ç¶„Ç©„Éº„ÇØ", "description": "ÊúüÈñìÈôêÂÆöÂêà‰ΩúÔºÅÂåñË∫´Ëó•Â∏´ÔºåËàáË≤ìË≤ì‰∏ÄËµ∑Âú®ÂúíÂçÄÂÖßËß£ÈñãË¨éÈ°å„ÄÇ", "mapLink": "https://www.google.com/maps/search/?api=1&query=Universal+Studios+Japan" } ] },
                { "day": 6, "date": "2025-09-18", "theme": "‰∫¨ÈÉΩ‰∏ÄÊó•ÈÅä", "location": "Kyoto", "activities": [ { "time": "Áï∂Êó•‰ΩèÂÆø", "title": "Êù±Ê©´INN Â§ßÈò™Ê¢ÖÁî∞Êù±", "description": "ÊóÖÁ®ãÁ¨¨‰∏âËá≥ÂçÅÊó•ÁöÑ‰∏ãÊ¶ªÈÖíÂ∫ó„ÄÇ", "transport": "‰ΩçÊñºÊ¢ÖÁî∞Êù±Âú∞Âå∫ÔºåÈÑ∞ËøëÂú∞ÈêµÁ´ô„ÄÇ", "mapLink": "https://www.google.com/maps/search/?api=1&query=Toyoko+Inn+Osaka+Umeda+Higashi" }, { "time": "‰∏äÂçà", "title": "ÂâçÂæÄ‰∫¨ÈÉΩ & Ê∏ÖÊ∞¥ÂØ∫ÈÅì", "description": "ÂæûÈÖíÂ∫óÂá∫ÁôºÔºåÂâçÂæÄÊ∏ÖÊ∞¥ÂØ∫„ÄÇÂèÉÊãúÂÆåÂÆèÂÅâÂòÖÊ∏ÖÊ∞¥ËàûÂè∞ÂæåÔºåÊ≤ø‰ΩèÂÖÖÊªøÂè§ÈÉΩÈ¢®ÊÉÖÂòÖ‰∫åÂπ¥ÂùÇ„ÄÅ‰∏âÂπ¥ÂùÇÁü≥ÊùøË∑ØÊÖ¢ÊÖ¢Ë°åËêΩÂ±±„ÄÇ", "transport": "Áî±„ÄåÂ§ßÈò™/Ê¢ÖÁî∞Á´ô„ÄçÊê≠‰πò JR‰∫¨ÈÉΩÁ∑öÊñ∞Âø´ÈÄüÔºåÁ¥Ñ30ÂàÜÈêòÁõ¥ÈÅî„Äå‰∫¨ÈÉΩÁ´ô„ÄçÔºåÂÜçËΩâ‰πòÂ∑¥Â£´ÂâçÂæÄ (Á¥Ñ15ÂàÜÈêò)„ÄÇ", "mapLink": "https://www.google.com/maps/search/?api=1&query=Kiyomizu-dera+Temple" }, { "time": "‰∏≠Âçà", "title": "Á•áÂúí„ÉªËä±Ë¶ãÂ∞èË∑Ø", "description": "È†ÜË∑ØË°åÂà∞ÂÖ´ÂùÇÁ•ûÁ§æÔºåÁÑ∂ÂæåÈÄ≤ÂÖ•Á•áÂúíÂú∞ÂçÄ„ÄÇ‰Ω†ÂèØ‰ª•Âñ∫Ëä±Ë¶ãÂ∞èË∑ØÊÑüÂèóËóùÂ¶ìÊñáÂåñÂòÖÊ∞õÂúçÔºå‰∏¶Âñ∫ÈôÑËøëÊêµÈñìÈ§êÂª≥È£üÂçàÈ§ê„ÄÇ", "transport": "ÂæûÊ∏ÖÊ∞¥ÂØ∫Ê≠•Ë°åÂâçÂæÄ (Á¥Ñ20ÂàÜÈêò)„ÄÇ", "mapLink": "https://www.google.com/maps/search/?api=1&query=Gion+Hanamikoji" }, { "time": "ÂÇçÊôö", "title": "ËøîÂõûÂ§ßÈò™", "description": "Âú®‰∫¨ÈÉΩÈ£üÂÆåÊôöÈ£ØÔºåÊàñËÄÖËøîÂà∞Â§ßÈò™ÂÜçÈ£üÔºåÁÑ∂ÂæåËøîÈÖíÂ∫ó‰ºëÊÅØ„ÄÇ", "transport": "Âæû„ÄéËøëÈêµ‰∫¨ÈÉΩÁ´ô„ÄèÊê≠‰πòÊÄ•Ë°åÔºåÊñº„ÄéÂ§ßÂíåË•øÂ§ßÂØ∫„ÄèËΩâËªäÂæÄ„ÄéÂ§ßÈò™Èõ£Ê≥¢„Äè(Á∏ΩÁ®ãÁ¥Ñ50-60ÂàÜÈêòÔºåPassÈÅ©Áî®)„ÄÇ", "mapLink": "https://www.google.com/maps/search/?api=1&query=Kyoto+Station" } ], "optionalActivities": [ { "title": "Èå¶Â∏ÇÂ†¥", "description": "Â¶ÇÊûúÊôÇÈñìË®±ÂèØÔºåÂèØ‰ª•ÂéªÊÑüÂèó„Äå‰∫¨ÈÉΩÂòÖÂªöÊàø„ÄçÂòÖÁÜ±È¨ßÊ∞£Ê∞õÔºåÈ£ü‰∏ãÂ∞èÈ£ü„ÄÇ", "mapLink": "https://www.google.com/maps/search/?api=1&query=Nishiki+Market" } ] },
                { "day": 7, "date": "2025-09-19", "theme": "‰ºäÂã¢Á•ûÂÆÆÂèÉÊãú", "location": "Ise", "activities": [ { "time": "‰∏äÂçà", "title": "ÂâçÂæÄ‰ºäÂã¢", "description": "Âú®Â§ßÈò™Ê¢ÖÁî∞ÈÖíÂ∫ó Check-outÔºåÂØÑÂ≠òÂ§ß‰ª∂Ë°åÊùé„ÄÇËºïË£ùÂâçÂæÄ„ÄåÂ§ßÈò™Èõ£Ê≥¢Á´ô„Äç„ÄÇ", "transport": "Áî® Pass ÊèõÈ†ò„ÄêÁ¨¨‰∏ÄÂºµÁâπÊÄ•Âà∏„ÄëÔºåÊê≠‰πòËøëÈêµÁâπÊÄ•Áõ¥ÈÅî„ÄåÂÆáÊ≤ªÂ±±Áî∞Á´ô„Äç(Á¥Ñ1Â∞èÊôÇ50ÂàÜÈêò)„ÄÇ", "mapLink": "https://www.google.com/maps/search/?api=1&query=Ujiyamada+Station" }, { "time": "‰∏ãÂçà", "title": "‰ºäÂã¢Á•ûÂÆÆÂèÉÊãú", "description": "ÂèÉÊãú‰ºäÂã¢Á•ûÂÆÆ (Â§ñÂÆÆÂèäÂÖßÂÆÆ)Ôºå‰∏¶Âñ∫„ÄåÊâòÁ¶èÊ©´‰∏Å„Äç‰∫´ÂèóÁæéÈ£ü„ÄÇ", "transport": "Êê≠‰πòÂ∑¥Â£´ÊàñÊ≠•Ë°å„ÄÇ", "mapLink": "https://www.google.com/maps/search/?api=1&query=Ise+Grand+Shrine" }, { "time": "Â§úÊôö", "title": "ÂÖ•‰Ωè: ‰ºäË≥Ä‰∏äÈáé„Ç∑„ÉÜ„Ç£„Éõ„ÉÜ„É´", "description": "Âæû‰ºäÂã¢Âá∫ÁôºÔºåÂâçÂæÄ‰ºäË≥Ä‰∏äÈáéÁöÑÈÖíÂ∫óËæ¶ÁêÜÂÖ•‰ΩèÔºåÁÇ∫ÊòéÊó•ÁöÑÂøçËÄÖ‰øÆË°åÂÅöÊ∫ñÂÇô„ÄÇ", "transport": "Âæû„ÄéÂÆáÊ≤ªÂ±±Áî∞Á´ô„ÄèÊê≠‰πòËøëÈêµÂà∞„Äé‰ºäË≥ÄÁ•ûÊà∏Á´ô„Äè(Á¥Ñ1Â∞èÊôÇ)ÔºåÂÜçËΩâ‰πò‰ºäË≥ÄÈêµÈÅìÂà∞„Äé‰∏äÈáéÂ∏ÇÁ´ô„Äè(Á¥Ñ25ÂàÜÈêò)„ÄÇ", "mapLink": "https://www.google.com/maps/search/?api=1&query=Iga+Ueno+City+Hotel" } ] },
                { "day": 8, "date": "2025-09-20", "theme": "ÂøçËÄÖÈ´îÈ©ó & Yorushika ÊºîÂî±ÊúÉ", "location": "Nagoya", "activities": [ { "time": "Áï∂Êó•‰ΩèÂÆø", "title": "Êù±Ê©´INNÂêçÂè§Â±ãÊ¶Æ", "description": "Âú®ÂêçÂè§Â±ãÁöÑ‰∏ãÊ¶ªÈÖíÂ∫óÔºåÈÑ∞ËøëÊ¶ÆÂïÜÂúàÔºåÊñπ‰æøÈÄõË°óËàáÁî®È§ê„ÄÇ", "transport": "ÂæûÂêçÂè§Â±ãÁ´ôÊê≠‰πòÂú∞ÈêµÊù±Â±±Á∑öËá≥„ÄéÊ¶ÆÁ´ô„Äè„ÄÇ", "mapLink": "https://www.google.com/maps/search/?api=1&query=Toyoko+Inn+Nagoya+Sakae" }, { "time": "‰∏äÂçà", "title": "‰ºäË≥Ä‰∏äÈáéÂüé & ÂøçËÄÖÂçöÁâ©È§®", "description": "Âú®ÈÖíÂ∫ó Check-out ÂæåÔºåÂ∞áË°åÊùéÂØÑÂ≠òÂú®ËªäÁ´ôÂÑ≤Áâ©Ê´É„ÄÇÁÑ∂ÂæåÂèÉËßÄ‰ºäË≥Ä‰∏äenoÂüéÂèäÊóÅÈÇäÁöÑ‰ºäË≥ÄÊµÅÂøçËÄÖÂçöÁâ©È§®„ÄÇ", "transport": "Ê≠•Ë°å", "mapLink": "https://www.google.com/maps/search/?api=1&query=Iga+Ueno+Castle" }, { "time": "‰∏ãÂçà", "title": "ÂâçÂæÄÂêçÂè§Â±ã", "description": "Áî±„Äå‰ºäË≥ÄÁ•ûÊà∏Á´ô„ÄçÊèõÈ†ò„ÄêÁ¨¨‰∫åÂºµÁâπÊÄ•Âà∏„ÄëÔºåÊê≠‰πòËøëÈêµÁâπÊÄ•Áõ¥ÈÅî„ÄåËøëÈêµÂêçÂè§Â±ãÁ´ô„Äç(Á¥Ñ1Â∞èÊôÇ10ÂàÜÈêò)„ÄÇ", "transport": "ËøëÈêµÁâπÊÄ•„ÄÇ", "mapLink": "https://www.google.com/maps/search/?api=1&query=Kintetsu+Nagoya+Station" }, { "time": "18:00", "title": "Yorushika LIVE TOUR 2025„ÄåÁõó‰Ωú ÂÜçÊºî„Äç", "description": "16:30 ÈñãÂ†¥Ôºå18:00 ÈñãÊºî„ÄÇÊ∫ñÂÇôÂÖ•Â†¥ÔºåÊ¨£Ë≥û Yorushika „ÅÆÁ≤æÂΩ©ÊºîÂá∫ÔºÅ", "transport": "Êê≠‰πòÂêçÂè§Â±ãÂ∏ÇÂÖß‰∫§ÈÄö„ÄÇ", "mapLink": "https://www.google.com/maps/search/?api=1&query=IG+Arena+Nagoya" } ] },
                { "day": 9, "date": "2025-09-21", "theme": "Ê∞¥ÈÉΩ„Åè„Çâ„Çè„Çì„ÅãËä±ÁÅ´Â§ßÊúÉ", "location": "Osaka", "notes": ["Ê≥®ÊÑèÔºöËä±ÁÅ´Â§ßÊúÉÁöÑÁ¢∫ÂàáËàâËæ¶Êó•ÊúüÂíåÊôÇÈñìÔºåË´ãÂú®Âá∫ÁôºÂâçÂÜçÊ¨°Âà∞ÂÆòÊñπÁ∂≤Á´ôÁ¢∫Ë™ç„ÄÇ"], "activities": [ { "time": "Áï∂Êó•‰ΩèÂÆø", "title": "Êù±Ê©´INN Â§ßÈò™Ê¢ÖÁî∞Êù±", "description": "ÊóÖÁ®ãÁ¨¨‰∏âËá≥ÂçÅÊó•ÁöÑ‰∏ãÊ¶ªÈÖíÂ∫ó„ÄÇ", "transport": "‰ΩçÊñºÊ¢ÖÁî∞Êù±Âú∞ÂçÄÔºåÈÑ∞ËøëÂú∞ÈêµÁ´ô„ÄÇ", "mapLink": "https://www.google.com/maps/search/?api=1&query=Toyoko+Inn+Osaka+Umeda+Higashi" }, { "time": "‰∏≠Âçà", "title": "ËøîÂõûÂ§ßÈò™", "description": "Âú®ÂêçÂè§Â±ãÊÇ†ÈñíÊ∏°ÈÅé‰∏äÂçàÂæå Check-out„ÄÇÊèõÈ†ò„ÄêÁ¨¨‰∏âÂºµÁâπÊÄ•Âà∏„ÄëÔºåÊê≠‰πòË±™ËèØÁâπÊÄ•„Äå„Å≤„ÅÆ„Å®„Çä (Hinotori)„ÄçËøîÂõû„ÄåÂ§ßÈò™Èõ£Ê≥¢Á´ô„Äç(Á¥Ñ2Â∞èÊôÇ)„ÄÇ", "transport": "ËøëÈêµË±™ËèØÁâπÊÄ• „Å≤„ÅÆ„Å®„Çä„ÄÇ", "mapLink": "https://www.google.com/maps/search/?api=1&query=Osaka-Namba+Station" }, { "time": "‰∏ãÂçà", "title": "ËøîÂõûÊ¢ÖÁî∞ÈÖíÂ∫ó", "description": "ËøîÂà∞Ê¢ÖÁî∞ÂòÖÂéüÈÖíÂ∫óÊîûËøîË°åÊùé‰∏¶ Check-inÔºåÁ®ç‰Ωú‰ºëÊÅØ„ÄÇ", "transport": "Âæû„ÄéÈõ£Ê≥¢Á´ô„ÄèÊê≠‰πòÂæ°Â†ÇÁ≠ãÁ∑öÂà∞„ÄéÊ¢ÖÁî∞Á´ô„Äè(Á¥Ñ8ÂàÜÈêò)„ÄÇ", "mapLink": "https://www.google.com/maps/search/?api=1&query=Toyoko+Inn+Osaka+Umeda+Higashi" }, { "time": "ÂÇçÊôö", "title": "Ê∞¥ÈÉΩ„Åè„Çâ„Çè„Çì„ÅãËä±ÁÅ´Â§ß‰ºö", "description": "ÂâçÂæÄÊ∑ÄÂ∑ùÊ≤≥Â∑ùÂÖ¨ÂúíÔºåÊ¨£Ë≥ûÂú®Ê≤≥Â≤∏Á∂ªÊîæÁöÑÁõõÂ§ßÁÖôËä±ÔºåÁÇ∫ÊóÖÁ®ãÂ¢ûÊ∑ªÊµ™Êº´ÂõûÊÜ∂„ÄÇ", "transport": "Âæû JR„ÄéÂ§ßÈò™Á´ô„ÄèÊê≠‰πòJR‰∫¨ÈÉΩÁ∑öÂà∞„ÄéÈ´òÊßªÁ´ô„Äè(Á¥Ñ15ÂàÜÈêò)ÂæåÊ≠•Ë°å„ÄÇ", "mapLink": "https://www.google.com/maps/search/?api=1&query=Yodogawa+Kasen+Park+Hirakata" } ] },
                { "day": 10, "date": "2025-09-22", "theme": "ÊúÄÂæåÊé°Ë≥º & ËøîÁ®ã", "location": "Osaka", "activities": [ { "time": "‰∏äÂçà", "title": "ÊúÄÂæåÊé°Ë≥º", "description": "Âú®Ê¢ÖÁî∞Âú∞ÂçÄÈÄ≤Ë°åÊúÄÂæåÁöÑË≥ºÁâ©ÔºåË≥ºË≤∑Êâã‰ø°ÊàñË£úË≤®„ÄÇ", "transport": "Ê≠•Ë°åÊàñÊê≠‰πòÂú∞Èêµ„ÄÇ", "mapLink": "https://www.google.com/maps/search/?api=1&query=Umeda+Station" }, { "time": "‰∏≠Âçà", "title": "ÈÄÄÊàøËàáÂØÑÂ≠òË°åÊùé", "description": "ËøîÂõûÈÖíÂ∫óËæ¶ÁêÜÈÄÄÊàøÊâãÁ∫åÔºå‰∏¶Â∞áË°åÊùéÂØÑÂ≠òÂú®ÈÖíÂ∫ó„ÄÇ", "transport": "Ê≠•Ë°å", "mapLink": "https://www.google.com/maps/search/?api=1&query=Toyoko+Inn+Osaka+Umeda+Higashi" }, { "time": "‰∏ãÂçà", "title": "ÊÇ†Èñí‰∏ãÂçàËå∂", "description": "Âú®Ê¢ÖÁî∞Êâæ‰∏ÄÂÆ∂ÂíñÂï°Âª≥ÔºåÊÇ†ÈñíÂú∞Â∫¶ÈÅé‰∏äÊ©üÂâçÁöÑÊúÄÂæåÊôÇÂÖâ„ÄÇ", "transport": "Ê≠•Ë°å", "mapLink": "https://www.google.com/maps/search/?api=1&query=Umeda+cafe" }, { "time": "17:30", "title": "È†òÂèñË°åÊùé & ÂâçÂæÄÊ©üÂ†¥ (MM067)", "description": "Ëà™Áè≠ MM067 Êñº 20:40 Ëµ∑È£õ„ÄÇÂª∫Ë≠∞ÊúÄÈÅ≤Êñº 17:30 È†òÂèñË°åÊùéÂæåÂá∫ÁôºÔºåÁõÆÊ®ôÂú® 18:10 ÂâçÂà∞ÈÅîÊ©üÂ†¥Â∑¥Â£´Á´ô„ÄÇ", "transport": "ÂæûÊ¢ÖÁî∞Âú∞ÂçÄÊê≠‰πòÊ©üÂ†¥Â∑¥Â£´ (Airport Limousine Bus) ÊòØÊúÄÊñπ‰æøÁöÑÈÅ∏Êìá (Á¥Ñ60ÂàÜÈêò)„ÄÇ", "mapLink": "https://www.google.com/maps/search/?api=1&query=Kansai+International+Airport" } ] }
            ],
            "foodieList": [
                { "name": "Á•ûÂ∫ßÊãâÈ∫µ („Å©„ÅÜ„Å®„Çì„Åº„ÇäÁ•ûÂ∫ß)", "region": "Èõ£Ê≥¢", "tag": "ÊãâÈ∫µ", "mapLink": "https://www.google.com/maps/search/?api=1&query=Dotonbori+Kamukura+Ramen" },
                { "name": "PABLO ËäùÂ£´Êíª", "region": "Èõ£Ê≥¢", "tag": "ÁîúÂìÅ", "mapLink": "https://www.google.com/maps/search/?api=1&query=PABLO+Cheesetart+Namba" },
                { "name": "ÁáíËÇâ M Ê≥ïÂñÑÂØ∫Ê©´‰∏ÅÁ∏ΩÂ∫ó", "region": "Èõ£Ê≥¢", "tag": "ÁáíËÇâ", "mapLink": "https://www.google.com/maps/search/?api=1&query=Yakiniku+M+Hozenji+Yokocho" },
                { "name": "„ÅØ„ÇäÈáç ÈÅìÈ†ìÂ†ÄÊú¨Â∫ó", "region": "Èõ£Ê≥¢", "tag": "Â£ΩÂñúÁáí", "mapLink": "https://www.google.com/maps/search/?api=1&query=„ÅØ„ÇäÈáç+ÈÅìÈ†ìÂ†ÄÊú¨Â∫ó" },
                { "name": "ÁÑºËÇâËê¨Èáé ÂøÉÊñéÊ©ãÂ∫ó", "region": "Èõ£Ê≥¢", "tag": "ÁáíËÇâ", "mapLink": "https://www.google.com/maps/search/?api=1&query=ÁÑºËÇâËê¨Èáé+ÂøÉÊñéÊ©ãÂ∫ó" },
                { "name": "È∫∫Â±ã „ÅÆ„Çπ„ÅüOSAKA Èõ£Ê≥¢ÂçÉÊó•ÂâçÂ∫ó", "region": "Èõ£Ê≥¢", "tag": "ÊãâÈ∫µ", "mapLink": "https://www.google.com/maps/search/?api=1&query=È∫∫Â±ã+„ÅÆ„Çπ„ÅüOSAKA+Èõ£Ê≥¢ÂçÉÊó•ÂâçÂ∫ó" },
                { "name": "„Åç„Åò Â§ßÈò™Ááí", "region": "Ê¢ÖÁî∞", "tag": "Â§ßÈò™Ááí", "mapLink": "https://www.google.com/maps/search/?api=1&query=Okonomiyaki+Kiji+Umeda" },
                { "name": "HARBS Ê∞¥ÊûúÂçÉÂ±§ËõãÁ≥ï", "region": "Ê¢ÖÁî∞", "tag": "ÁîúÂìÅ", "mapLink": "https://www.google.com/maps/search/?api=1&query=HARBS+Daimaru+Umeda" },
                { "name": "Ëå∂ÂØÆÈÉΩË∑ØÈáå Á•áÂúíÊú¨Â∫ó", "region": "‰∫¨ÈÉΩ", "tag": "ÁîúÂìÅ", "mapLink": "https://www.google.com/maps/search/?api=1&query=Saryo+Tsujiri+Gion+Main+Store" },
                { "name": "„Åæ„Åô„Åü„Å´ÊãâÈ∫µ", "region": "‰∫¨ÈÉΩ", "tag": "ÊãâÈ∫µ", "mapLink": "https://www.google.com/maps/search/?api=1&query=Masutani+Ramen+Kyoto" },
                { "name": "Áü¢Â†¥„Å®„Çì Âë≥ÂôåË±¨Êéí", "region": "ÂêçÂè§Â±ã", "tag": "Ë±¨Êéí", "mapLink": "https://www.google.com/maps/search/?api=1&query=Yabaton+Yaba-cho+Head+Office" },
                { "name": "Cafe Tanaka", "region": "ÂêçÂè§Â±ã", "tag": "ÁîúÂìÅ", "mapLink": "https://www.google.com/maps/search/?api=1&query=Cafe+Tanaka+Nagoya" }
            ],
            "coupons": [ { "name": "Bic Camera", "discount": "ÊªøÈ°çÂÖçÁ®ÖÔºåÊúÄÈ´òÂÜçÊäò7%", "expiry": "2025/8/31", "link": "https://funtime.tw/c/blog-68172-1", "final_url": "https://www.funtime.com.tw/travelstore/coupon/BicCamera_vertical.jpg", "category": "ÈõªÂô®" }, { "name": "Salonia", "discount": "Êäò5%(ÈúÄËàáBic CameraÂÑ™ÊÉ†Âà∏‰∏ÄËµ∑‰ΩøÁî®)", "expiry": "2025/8/31", "link": "https://funtime.tw/c/blog-68172-19", "final_url": "https://www.funtime.com.tw/travelstore/coupon/Salonia_250415.jpg?ftfrom=blog-68172-19", "category": "ÈõªÂô®" }, { "name": "ÊÑõÈõªÁéãEdion", "discount": "ÊªøÈ°çÂÖçÁ®ÖÔºåÊúÄÈ´òÂÜçÊäò7%", "expiry": "2026/12/31", "link": "https://funtime.tw/c/blog-68172-10", "final_url": "https://www.funtime.com.tw/travelstore/coupon/edion2025.jpg", "category": "ÈõªÂô®" }, { "name": "Laox", "discount": "ÊªøÈ°çÂÖçÁ®ÖÔºåÂÜçÊäò8%", "expiry": "2025/12/31", "link": "https://funtime.tw/c/blog-68172-15", "final_url": "https://www.funtime.com.tw/travelstore/coupon/LAOX_2025.jpg", "category": "ÈõªÂô®" }, { "name": "SUNDRUG", "discount": "ÊªøÈ°çÂÖçÁ®ÖÔºåÂÜç‰∫´3~7%ÊäòÊâ£", "expiry": "ÁÑ°ÊúüÈôê", "link": "https://funtime.tw/c/b2s50T", "final_url": "https://www.funtime.com.tw/travelstore/coupon/sundrug%20_funtime.jpg", "category": "Ëó•Â¶ù" }, { "name": "È∂¥ÁæΩËó•Â¶ù", "discount": "ÊªøÈ°çÂÖçÁ®ÖÔºåÊúÄÈ´ò‰∫´ÂÖçÁ®Ö+7%ÂÑ™ÊÉ†", "expiry": "2025/12/31", "link": "https://funtime.tw/c/blog-68172-11", "final_url": "https://www.funtime.com.tw/travelstore/coupon/tsuruha2025.jpg", "category": "Ëó•Â¶ù" }, { "name": "Êú≠ÂπåËó•Â¶ù", "discount": "ÊªøÈ°çÂÖçÁ®ÖÔºåÊúÄÈ´ò‰∫´ÂÖçÁ®Ö+5%ÂÑ™ÊÉ†", "expiry": "ÁÑ°ÊúüÈôê", "link": "https://funtime.tw/c/blog-68172-13", "final_url": "https://www.funtime.com.tw/travelstore/coupon/sapporo.jpg", "category": "Ëó•Â¶ù" }, { "name": "Cosmos", "discount": "ÊªøÈ°çÂÖçÁ®ÖÔºåÊúÄÈ´ò‰∫´ÂÖçÁ®Ö+9%ÂÑ™ÊÉ†", "expiry": "2025/12/31", "link": "https://funtime.tw/c/DsrcXF", "final_url": "https://www.funtime.com.tw/travelstore/coupon/cosmos2025.jpg", "category": "Ëó•Â¶ù" }, { "name": "ËøëÈêµÁôæË≤®Â∫ó", "discount": "Êªø2ÂçÉÊó•Âúì(‰∏çÂê´Á®Ö)ÔºåÂèØ‰∫´Êúâ95ÊäòÂÑ™ÊÉ†", "expiry": "2025/12/31", "link": "https://funtime.tw/c/blog-68172-14", "final_url": "https://www.funtime.com.tw/travelstore/coupon/kintetsu2025.png", "category": "ÁôæË≤®", "region": "ÈóúË•ø" }, { "name": "Â§ß‰∏∏ÊùæÂùÇÂ±ã", "discount": "ÂñÆÁ≠ÜÊ∂àË≤ªÂê´Á®ÖÊªø3ÂçÉÊó•ÂúìÔºå‰∫´95Êäò", "expiry": "2025/8/31", "link": "https://funtime.tw/c/blog-68172-6", "final_url": "https://www.funtime.com.tw/travelstore/coupon/daimaru_2.pdf", "category": "ÁôæË≤®" }, { "name": "Ë•øÊ≠¶ÁôæË≤®", "discount": "Ê∂àË≤ªÊªø1ÂçÉÊó•ÂúìÔºå‰∫´95Êäò", "expiry": "2025/12/31", "link": "https://funtime.tw/c/blog-68172-2", "final_url": "https://www.funtime.com.tw/travelstore/coupon/seibu2025.png", "category": "ÁôæË≤®" }, { "name": "ÂêçÂè§Â±ãÂêçÈêµÁôæË≤®Â∫ó", "discount": "ÂÖçÁ®ÖÂÜçÊäò5%", "expiry": "2026/2/28", "link": "https://funtime.tw/c/blog-68172-18", "final_url": "https://www.funtime.com.tw/travelstore/coupon/meitetsu_250516.png", "category": "ÁôæË≤®", "region": "ÂêçÂè§Â±ã" }, { "name": "‰∫¨ÁéãÁôæË≤®", "discount": "ÂñÆÁ≠ÜÊ∂àË≤ªÊªø3ÂçÉÊó•ÂúìÔºå‰∫´95Êäò", "expiry": "2026/03/31", "link": "https://funtime.tw/c/blog-68172-3", "final_url": "https://www.funtime.com.tw/travelstore/coupon/Keio_2.jpeg", "category": "ÁôæË≤®", "region": "Êù±‰∫¨" }, { "name": "Â∞èÁî∞ÊÄ•ÁôæË≤®", "discount": "Ê∂àË≤ªÊªø1ÂçÉÊó•Âúì(Âê´Á®Ö)ÔºåÂèØ‰∫´6%ÂÑ™ÊÉ†", "expiry": "2028/3/31", "link": "https://funtime.tw/c/blog-68172-12", "final_url": "https://www.funtime.com.tw/travelstore/coupon/odakyu.png", "category": "ÁôæË≤®", "region": "Êù±‰∫¨" }, { "name": "DonkiÂîêÂêâË®∂Âæ∑", "discount": "ÊªøÈ°çÂÖçÁ®ÖÔºåÂÜçÊäò5%", "expiry": "ÁÑ°ÊúüÈôê", "link": "https://funtime.tw/c/blog-68172-9", "final_url": "https://japanportal.donki-global.com/coupon/?ptcd=0076003303", "category": "Á∂úÂêà/ÂÖçÁ®Ö" }, { "name": "ÈäÄÂ∫ßÊ®ÇÂ§©ÂÖçÁ®ÖÂ∫ó", "discount": "Êªø1Ëê¨Êó•ÂúìÊäò1ÂçÉÔºåÊªø2Ëê¨Êäò2ÂçÉ", "expiry": "2026/1/31", "link": "https://funtime.tw/c/blog-68172-7", "final_url": "https://www.funtime.com.tw/travelstore/coupon/Lottedutyfree_GINZA_FunTime2025.jpg", "category": "Á∂úÂêà/ÂÖçÁ®Ö", "region": "Êù±‰∫¨" }, { "name": "ÊàêÁî∞Ê©üÂ†¥ÂÖçÁ®ÖÂ∫ó", "discount": "‰∫´Êúâ95ÊäòÂÑ™ÊÉ†", "expiry": "2026/3/31", "link": "https://funtime.tw/c/blog-68172-16", "final_url": "https://duty-free-japan.jp/narita/ta/content/coupon2833-30.html", "category": "Á∂úÂêà/ÂÖçÁ®Ö", "region": "Êù±‰∫¨" }, { "name": "ÊàêÁî∞/ÁæΩÁî∞Ê©üÂ†¥ ÂÖçÁ®ÖÂïÜÂìÅÁ∑ö‰∏äË®Ç", "discount": "‰∫´Êúâ95ÊäòÂÑ™ÊÉ†", "expiry": "ÁÑ°ÊúüÈôê", "link": "https://funtime.tw/c/blog-68172-17", "final_url": "https://duty-free-japan.jp/qrposter/tc/?agentid=123", "category": "Á∂úÂêà/ÂÖçÁ®Ö", "region": "Êù±‰∫¨" }, { "name": "VictoriaÈÅãÂãïÁî®ÂìÅ", "discount": "ÂÖçÁ®ÖÂÜçÊäò5%", "expiry": "2026/6/30", "link": "https://funtime.tw/c/blog-68172-8", "final_url": "https://www.funtime.com.tw/travelstore/coupon/FunTime_Victoria_202606.jpg", "category": "ÂÖ∂‰ªñ" } ]
        };

        // üöÄ 4.2: APPLICATION LOGIC
        document.addEventListener('DOMContentLoaded', () => {
            const appState = { weatherByLocation: {} };

            // --- Element Getters ---
            const getEl = (id) => document.getElementById(id);
            const mainPageWrapper = getEl('main-page-wrapper');
            const detailPage = getEl('detail-page');
            const mainTitle = getEl('main-title');
            const itineraryView = getEl('itinerary-view');
            const foodieView = getEl('foodie-view');
            const couponView = getEl('coupon-view');
            const detailHeader = getEl('detail-header');
            const detailContent = getEl('detail-content');
            const navContainer = getEl('nav-container');
            const couponModal = getEl('coupon-modal');
            const couponModalContent = getEl('coupon-modal-content');

            // --- SVG Icon System ---
            function getIconSvg(name, options = {}) {
                const { classes = 'w-6 h-6', strokeWidth = 2 } = options;
                const icons = { 'list-ordered': `<line x1="10" x2="21" y1="6" y2="6"/><line x1="10" x2="21" y1="12" y2="12"/><line x1="10" x2="21" y1="18" y2="18"/><path d="M4 6h1v4"/><path d="M4 10h2"/><path d="M6 18H4l2-4H4l2-4"/>`, 'utensils-crossed': `<path d="m16 2-2.3 2.3a3 3 0 0 0 0 4.2l1.8 1.8a3 3 0 0 0 4.2 0L22 8Z"/><path d="M15 15 3.3 3.3a4.2 4.2 0 0 0 0 6l7.3 7.3c.7.7 2 .7 2.8 0L15 15Zm0 0 7 7"/><path d="m2.1 2.1 6.4 6.4"/>`, 'ticket': `<path d="M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z"/><path d="M13 5v2"/><path d="M13 17v2"/><path d="M13 11v2"/>`, 'arrow-left': `<path d="m12 19-7-7 7-7"/><path d="M19 12H5"/>`, 'x': `<path d="M18 6 6 18"/><path d="m6 6 12 12"/>`, 'map-pin': `<path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"/><circle cx="12" cy="10" r="3"/>`, 'bell-ring': `<path d="M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9"/><path d="M10.3 21a1.94 1.94 0 0 0 3.4 0"/><path d="M4 2C2.8 3.7 2 5.7 2 8"/><path d="M20 8c0-2.3-.8-4.3-2-6"/>`, 'alert-triangle': `<path d="m21.73 18-8-14a2 2 0 0 0-3.46 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"/><path d="M12 9v4"/><path d="M12 17h.01"/>`, 'tram-front': `<rect width="16" height="16" x="4" y="3" rx="2"/><path d="M4 11h16"/><path d="M12 3v-2"/><path d="M8 19v2"/><path d="M16 19v2"/><path d="M12 19v-3h-2a2 2 0 0 0-2 2v1h6v-1a2 2 0 0 0-2-2Z"/>`, 'plug-zap': `<path d="M13 2v8h6"/><path d="M12 12h-2a4 4 0 0 1-4-4V2"/><path d="M8 18v-2.5"/><path d="M10 10l-2 2.5"/><path d="M14 10l2 2.5"/><path d="M12 22v-6"/><path d="M7 12H2"/><path d="M17 12h5"/>`, 'pilcrow': `<path d="M13 4v16"/><path d="M17 4v16"/><path d="M19 4H9.5a4.5 4.5 0 0 0 0 9H13"/>`, 'shopping-bag': `<path d="M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z"/><path d="M3 6h18"/><path d="M16 10a4 4 0 0 1-8 0"/>`, 'gem': `<path d="M6 3h12l4 6-10 13L2 9Z"/><path d="M12 22V9"/><path d="m3.29 9 8.71 13 8.71-13L12 3Z"/>`, 'shopping-cart': `<circle cx="8" cy="21" r="1"/><circle cx="19" cy="21" r="1"/><path d="M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.16"/>`, 'image': `<rect width="18" height="18" x="3" y="3" rx="2" ry="2"/><circle cx="9" cy="9" r="2"/><path d="m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21"/>`, 'link-2': `<path d="M9 17H7A5 5 0 0 1 7 7h2"/><path d="M15 7h2a5 5 0 1 1 0 10h-2"/><line x1="8" x2="16" y1="12" y2="12"/>`, 'sparkles': `<path d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z"/><path d="M5 3v4"/><path d="M19 17v4"/><path d="M3 5h4"/><path d="M17 19h4"/>`};
                const svgContent = icons[name] || '';
                return `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="${strokeWidth}" stroke-linecap="round" stroke-linejoin="round" class="${classes}">${svgContent}</svg>`;
            }

            // --- Helper Functions ---
            const delay = ms => new Promise(res => setTimeout(res, ms));
            function formatDate(dateString) { const date = new Date(dateString); date.setMinutes(date.getMinutes() + date.getTimezoneOffset()); const month = date.getMonth() + 1; const dayOfMonth = date.getDate(); const weekday = ["Êó•", "‰∏Ä", "‰∫å", "‰∏â", "Âõõ", "‰∫î", "ÂÖ≠"][date.getDay()]; return `(${String(month).padStart(2, '0')}Êúà${String(dayOfMonth).padStart(2, '0')}Êó•, ÊòüÊúü${weekday})`; }
            function getWeatherIcon(code) { if ([0, 1].includes(code)) return '‚òÄÔ∏è'; if ([2].includes(code)) return '‚õÖÔ∏è'; if ([3].includes(code)) return '‚òÅÔ∏è'; if ([45, 48].includes(code)) return 'üå´Ô∏è'; if ([51, 53, 55, 61, 63, 65, 80, 81, 82].includes(code)) return 'üåßÔ∏è'; if ([71, 73, 75, 77, 85, 86].includes(code)) return '‚ùÑÔ∏è'; if ([95, 96, 99].includes(code)) return '‚õàÔ∏è'; return 'üå°Ô∏è'; }

            function populateTemplate(templateId, data) {
                const template = getEl(templateId);
                if (!template) return null;
                const clone = template.content.cloneNode(true);
                Object.keys(data).forEach(key => {
                    clone.querySelectorAll(`[data-text="${key}"]`).forEach(el => el.textContent = data[key]);
                });
                return clone;
            }

            // --- Weather API ---
            async function fetchAllWeatherData(locations, itinerary) {
                const weatherByLocation = {};
                const startDate = itinerary[0].date;
                const endDate = itinerary[itinerary.length - 1].date;
                const today = new Date(config.simulationDate);
                const diffDays = Math.ceil((new Date(startDate) - today) / (1000 * 60 * 60 * 24));
                const isHistorical = diffDays > 16;
                
                let queryStartDate = startDate, queryEndDate = endDate;

                if (isHistorical) {
                    const start = new Date(startDate); start.setFullYear(start.getFullYear() - 1); queryStartDate = start.toISOString().split('T')[0];
                    const end = new Date(endDate); end.setFullYear(end.getFullYear() - 1); queryEndDate = end.toISOString().split('T')[0];
                }

                for (const [name, coords] of Object.entries(locations)) {
                    const url = isHistorical
                        ? `${config.api.weather.archive}?latitude=${coords.lat}&longitude=${coords.lon}&start_date=${queryStartDate}&end_date=${queryEndDate}&daily=weathercode,temperature_2m_max,temperature_2m_min&timezone=Asia%2FTokyo`
                        : `${config.api.weather.forecast}?latitude=${coords.lat}&longitude=${coords.lon}&daily=weathercode,temperature_2m_max,temperature_2m_min&timezone=Asia%2FTokyo&forecast_days=16`;
                    try {
                        const response = await fetch(url);
                        if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
                        const data = await response.json();
                        weatherByLocation[name] = { type: isHistorical ? 'historical' : 'forecast', daily: data.daily };
                    } catch (error) {
                        console.error(`Failed to fetch weather for ${name}:`, error);
                        weatherByLocation[name] = null;
                    }
                    await delay(250);
                }
                return weatherByLocation;
            }

            // --- Render Functions ---
            function renderItinerary() {
                itineraryView.innerHTML = '';
                const todayString = new Date(config.simulationDate).toISOString().split('T')[0];
                
                tripData.itinerary.forEach((day, index) => {
                    const data = { day: `Day ${day.day}`, date: formatDate(day.date), theme: day.theme };
                    const cardFragment = populateTemplate('template-itinerary-card', data);
                    const cardElement = cardFragment.firstElementChild;
                    
                    cardElement.dataset.dayIndex = index;
                    if (day.date === todayString) {
                        cardElement.className = 'bg-blue-900/50 border-2 border-blue-400 p-5 rounded-xl shadow-lg transition-all cursor-pointer ring-4 ring-blue-500/50';
                    }
                    if (day.notes?.length) {
                        cardElement.querySelector('.note-icon-container').innerHTML = getIconSvg('bell-ring', { classes: 'w-4 h-4 text-amber-400' });
                    }
                    
                    itineraryView.appendChild(cardElement);
                });
                
                const historicalNoteContainer = document.createElement('div');
                historicalNoteContainer.id = 'historical-note-container';
                itineraryView.appendChild(historicalNoteContainer);
            }

            function updateWeatherUI(weatherByLocation) {
                let isHistorical = false;
                tripData.itinerary.forEach((day, index) => {
                    const card = itineraryView.querySelector(`[data-day-index="${index}"]`);
                    const weatherEl = card?.querySelector('.weather-container');
                    if (!weatherEl) return;

                    const locationWeatherData = weatherByLocation[day.location];
                    if (locationWeatherData) {
                        if (locationWeatherData.type === 'historical') isHistorical = true;
                        const { daily } = locationWeatherData;
                        const weatherIndex = daily?.time?.findIndex(t => t.includes(day.date.substring(5)));
                        
                        if (weatherIndex > -1) {
                            const icon = getWeatherIcon(daily.weathercode[weatherIndex]);
                            const maxTemp = Math.round(daily.temperature_2m_max[weatherIndex]);
                            const minTemp = Math.round(daily.temperature_2m_min[weatherIndex]);
                            weatherEl.innerHTML = `<div class="text-right"><div class="text-2xl">${icon}</div><div class="text-xs text-gray-400">${minTemp}¬∞/${maxTemp}¬∞ ${locationWeatherData.type === 'historical' ? '*' : ''}</div></div>`;
                        } else { weatherEl.innerHTML = `<div>-</div>`; }
                    } else { weatherEl.innerHTML = `<div>-</div>`; }
                });

                const noteContainer = getEl('historical-note-container');
                if (isHistorical && noteContainer) {
                    noteContainer.innerHTML = `<p class="text-xs text-center text-gray-500 mt-4">* Â§©Ê∞£Ë≥áË®äÁÇ∫ÂéªÂπ¥ÂêåÊúüÊï∏ÊìöÔºåÂÉÖ‰æõÂèÉËÄÉ„ÄÇ</p>`;
                }
            }
            
            function renderFoodieList() {
                const foodieListContainer = getEl('foodie-list-container');
                foodieListContainer.innerHTML = ''; // Clear previous content

                const groupedFood = tripData.foodieList.reduce((acc, item) => {
                    (acc[item.region] = acc[item.region] || []).push(item);
                    return acc;
                }, {});

                config.categories.foodie.regionOrder.forEach(region => {
                    if (groupedFood[region]) {
                        const regionWrapper = document.createElement('div');
                        regionWrapper.innerHTML = `<h3 class="text-xl font-bold text-gray-100 my-4 border-b pb-2 border-gray-700">${region}</h3>`;
                        const listContainer = document.createElement('div');
                        listContainer.className = "space-y-3";
                        groupedFood[region].forEach(item => listContainer.appendChild(createFoodieCard(item)));
                        regionWrapper.appendChild(listContainer);
                        foodieListContainer.appendChild(regionWrapper);
                    }
                });
            }

            function createFoodieCard(item, isAi = false) {
                const cardFragment = populateTemplate('template-foodie-card', item);
                const cardElement = cardFragment.firstElementChild;
                cardElement.querySelector('.map-link').href = item.mapLink;
                cardElement.querySelector('.map-link').innerHTML = getIconSvg('map-pin', { classes: 'w-6 h-6 text-gray-300' });
                if (isAi) {
                    cardElement.querySelector('.ai-badge').classList.remove('hidden');
                }
                return cardElement;
            }
            
            function renderCoupons(){
                const couponListContainer = getEl('coupon-list-container');
                couponListContainer.innerHTML = ''; // Clear previous content

                const groupedCoupons = tripData.coupons.reduce((acc, coupon) => {
                    (acc[coupon.category] = acc[coupon.category] || []).push(coupon);
                    return acc;
                }, {});

                const { order, icons } = config.categories.coupons;

                order.forEach(category => {
                    if (groupedCoupons[category]) {
                        const categoryWrapper = document.createElement('div');
                        categoryWrapper.className = "space-y-2";

                        const categoryTitle = document.createElement('h3');
                        categoryTitle.className = "text-lg font-bold text-gray-200 flex items-center gap-2";
                        categoryTitle.innerHTML = `${getIconSvg(icons[category], { classes: 'w-5 h-5' })} ${category}`;
                        categoryWrapper.appendChild(categoryTitle);

                        const gridContainer = document.createElement('div');
                        gridContainer.className = "grid grid-cols-1 md:grid-cols-2 gap-4";
                        
                        groupedCoupons[category].forEach(coupon => {
                            const cardFragment = populateTemplate('template-coupon-card', coupon);
                            const cardElement = cardFragment.firstElementChild;
                            cardElement.dataset.finalUrl = coupon.final_url;
                            
                            const isImageUrl = /\.(jpeg|jpg|gif|png|webp|pdf)(\?.*)?$/i.test(coupon.final_url);
                            cardElement.querySelector('.link-icon-container').innerHTML = getIconSvg(isImageUrl ? 'image' : 'link-2', { classes: 'w-4 h-4 text-gray-400' });
                            
                            if(coupon.region) {
                                cardElement.querySelector('.region-tag').classList.remove('hidden');
                            }
                            gridContainer.appendChild(cardElement);
                        });
                        categoryWrapper.appendChild(gridContainer);
                        couponListContainer.appendChild(categoryWrapper);
                    }
                });
            }

            function renderDetailPage(dayIndex) {
                const dayData = tripData.itinerary[dayIndex];
                detailHeader.innerHTML = `<button id="back-button" class="p-2 rounded-full hover:bg-gray-700">${getIconSvg('arrow-left', { classes: 'w-6 h-6 text-gray-300' })}</button><h2 class="text-lg font-bold text-center text-gray-100 flex-grow truncate px-2">Day ${dayData.day} ${formatDate(dayData.date)}</h2>`;
                
                detailContent.innerHTML = '';
                const contentWrapper = document.createElement('div');
                contentWrapper.className = 'p-6';

                const locationWeatherData = appState.weatherByLocation[dayData.location];
                if (locationWeatherData) {
                    const { daily, type } = locationWeatherData;
                    const weatherIndex = daily?.time?.findIndex(t => t.includes(dayData.date.substring(5)));
                    if (weatherIndex > -1) {
                        const icon = getWeatherIcon(daily.weathercode[weatherIndex]);
                        const maxTemp = Math.round(daily.temperature_2m_max[weatherIndex]);
                        const minTemp = Math.round(daily.temperature_2m_min[weatherIndex]);
                        const weatherDiv = document.createElement('div');
                        weatherDiv.className = 'mb-6 p-4 bg-blue-900/30 rounded-lg flex items-center gap-4';
                        weatherDiv.innerHTML = `<div class="text-4xl">${icon}</div><div><p class="font-bold text-lg text-gray-100">${minTemp}¬∞C / ${maxTemp}¬∞C</p><p class="text-sm text-blue-300">${dayData.location} Â§©Ê∞£ ${type === 'historical' ? '(ÂéªÂπ¥ÂêåÊúü)' : ''}</p></div>`;
                        contentWrapper.appendChild(weatherDiv);
                    }
                }

                if (dayData.notes?.length) {
                    const notesContainer = document.createElement('div');
                    notesContainer.className = 'mb-6 space-y-2';
                    dayData.notes.forEach(note => {
                        const noteDiv = document.createElement('div');
                        noteDiv.className = 'bg-yellow-900/30 border-l-4 border-yellow-400 text-yellow-300 p-4 rounded-r-lg flex items-start gap-3';
                        noteDiv.innerHTML = `<div>${getIconSvg('alert-triangle', { classes: 'w-5 h-5' })}</div><p class="text-sm">${note}</p>`;
                        notesContainer.appendChild(noteDiv);
                    });
                    contentWrapper.appendChild(notesContainer);
                }

                dayData.activities.forEach(activity => {
                    const itemFragment = populateTemplate('template-timeline-item', activity);
                    const itemElement = itemFragment.firstElementChild;
                    const transportLink = itemElement.querySelector('.transport-link');
                    transportLink.href = activity.mapLink;
                    transportLink.insertAdjacentHTML('afterbegin', getIconSvg('tram-front', { classes: 'w-4 h-4' }));
                    transportLink.insertAdjacentHTML('beforeend', getIconSvg('map-pin', { classes: 'w-4 h-4 ml-auto' }));
                    contentWrapper.appendChild(itemElement);
                });

                if (dayData.optionalActivities?.length) {
                    const optionalContainer = document.createElement('div');
                    optionalContainer.className = 'mt-6 pt-6 border-t border-gray-700';
                    optionalContainer.innerHTML = `<h4 class="text-lg font-bold mb-4 text-gray-100">ÂΩàÊÄßÈÅ∏Êìá</h4>`;
                    const listWrapper = document.createElement('div');
                    listWrapper.className = 'space-y-4';
                    dayData.optionalActivities.forEach(optActivity => {
                        const itemFragment = populateTemplate('template-optional-activity', optActivity);
                        const itemElement = itemFragment.firstElementChild;
                        itemElement.href = optActivity.mapLink;
                        itemElement.insertAdjacentHTML('beforeend', getIconSvg('map-pin', { classes: 'w-5 h-5 text-gray-500 flex-shrink-0' }));
                        listWrapper.appendChild(itemElement);
                    });
                    optionalContainer.appendChild(listWrapper);
                    contentWrapper.appendChild(optionalContainer);
                }
                
                detailContent.appendChild(contentWrapper);
            }

            // --- Page Navigation & Static Components ---
            function showDetailPage(dayIndex) { renderDetailPage(dayIndex); detailPage.classList.remove('page-hidden'); mainPageWrapper.classList.add('hidden'); }
            function hideDetailPage() { detailPage.classList.add('page-hidden'); mainPageWrapper.classList.remove('hidden'); }
            function renderStaticComponents() {
                navContainer.innerHTML = `<button id="nav-itinerary" class="flex flex-col items-center justify-center text-blue-400 p-4 w-1/3">${getIconSvg('list-ordered', { classes: 'w-7 h-7' })}</button><button id="nav-foodie" class="flex flex-col items-center justify-center text-gray-400 p-4 w-1/3">${getIconSvg('utensils-crossed', { classes: 'w-7 h-7' })}</button><button id="nav-coupon" class="flex flex-col items-center justify-center text-gray-400 p-4 w-1/3">${getIconSvg('ticket', { classes: 'w-7 h-7' })}</button>`;
                couponModalContent.innerHTML = `<img id="modal-coupon-image" src="" alt="ÂÑ™ÊÉ†Âà∏Â§ßÂúñ" class="w-full h-auto rounded-lg"><button id="modal-close-button" class="absolute top-2 right-2 bg-gray-700 rounded-full p-1 text-gray-300 hover:bg-gray-600">${getIconSvg('x', { classes: 'w-6 h-6' })}</button>`;
                getEl('get-ai-suggestions').insertAdjacentHTML('afterbegin', getIconSvg('sparkles', { classes: 'w-5 h-5' }));
            }

            // --- Gemini AI Function ---
            async function getAiFoodSuggestions() {
                const button = getEl('get-ai-suggestions'), loader = getEl('ai-suggestions-loader'), errorContainer = getEl('ai-suggestions-error'), resultsContainer = getEl('ai-suggestions-results');
                button.disabled = true; button.classList.add('opacity-50', 'cursor-not-allowed');
                loader.classList.remove('hidden'); errorContainer.classList.add('hidden'); resultsContainer.innerHTML = '';

                try {
                    const todayString = new Date(config.simulationDate).toISOString().split('T')[0];
                    const currentDay = tripData.itinerary.find(day => day.date === todayString);
                    const targetRegion = currentDay ? currentDay.location : 'Osaka';

                    const existingNames = tripData.foodieList.map(item => item.name).join(', ');
                    const existingTags = [...new Set(tripData.foodieList.map(item => item.tag))].join(', ');

                    const prompt = `I am planning a trip to Japan. For my upcoming day in ${targetRegion}, please suggest THREE new, highly-rated restaurants. My food preferences include: ${existingTags}. I do not eat seafood. Crucially, do not suggest any of the following restaurants as I already know about them: ${existingNames}. Provide the response as a JSON array of objects, where each object has "name" (in Traditional Chinese), "region" ("${targetRegion}"), "tag", and "googleMapsQuery".`;
                    
                    const payload = { contents: [{ role: "user", parts: [{ text: prompt }] }], generationConfig: { responseMimeType: "application/json" } };
                    
                    const response = await fetch(`${config.api.gemini.url}?key=${config.api.gemini.apiKey}`, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(payload) });
                    if (!response.ok) throw new Error(`API request failed: ${response.statusText}`);
                    const result = await response.json();
                    
                    const suggestionsText = result.candidates?.[0]?.content?.parts?.[0]?.text;
                    if (suggestionsText) {
                        const suggestions = JSON.parse(suggestionsText);
                        if (suggestions?.length) {
                            suggestions.forEach(s => {
                                const newItem = { ...s, mapLink: `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(s.googleMapsQuery)}` };
                                resultsContainer.appendChild(createFoodieCard(newItem, true));
                            });
                        } else {
                             errorContainer.textContent = "AI Êâæ‰∏çÂà∞Á¨¶ÂêàÊ¢ù‰ª∂ÁöÑÊñ∞Âª∫Ë≠∞„ÄÇ";
                             errorContainer.classList.remove('hidden');
                        }
                    } else { throw new Error("Invalid API response structure."); }
                } catch (error) {
                    console.error("Error fetching AI suggestions:", error);
                    errorContainer.textContent = "ÁÑ°Ê≥ïÁç≤ÂèñÂª∫Ë≠∞ÔºåË´ãÁ®çÂæåÂÜçË©¶„ÄÇ";
                    errorContainer.classList.remove('hidden');
                } finally {
                    loader.classList.add('hidden');
                    button.disabled = false; button.classList.remove('opacity-50', 'cursor-not-allowed');
                }
            }

            // --- Event Listeners ---
            function setupEventListeners() {
                getEl('app-container').addEventListener('click', (e) => {
                    const target = e.target;
                    const itineraryCard = target.closest('[data-day-index]'), couponCard = target.closest('.coupon-card'), navButton = target.closest('button[id^="nav-"]');
                    if (itineraryCard) return showDetailPage(itineraryCard.dataset.dayIndex);
                    if (target.closest('#back-button')) return hideDetailPage();
                    if (target.closest('#get-ai-suggestions')) return getAiFoodSuggestions();
                    if (target.closest('#modal-close-button') || target === couponModal) return couponModal.classList.add('hidden');
                    if (couponCard) {
                        const url = couponCard.dataset.finalUrl;
                        if (/\.(jpeg|jpg|gif|png|webp|pdf)(\?.*)?$/i.test(url)) {
                            couponModal.querySelector('#modal-coupon-image').src = url;
                            couponModal.classList.remove('hidden');
                        } else { window.open(url, '_blank'); }
                        return;
                    }
                    if (navButton && navContainer.contains(navButton)) {
                        const views = { itinerary: itineraryView, foodie: foodieView, coupon: couponView };
                        const activeTab = navButton.id.split('-')[1];
                        Object.entries(views).forEach(([key, view]) => {
                            const isVisible = key === activeTab;
                            view.classList.toggle('hidden', !isVisible);
                            navContainer.querySelector(`#nav-${key}`).classList.toggle('text-blue-400', isVisible);
                            navContainer.querySelector(`#nav-${key}`).classList.toggle('text-gray-400', !isVisible);
                        });
                    }
                });
            }

            // --- Initialization ---
            function initialize() {
                mainTitle.textContent = tripData.tripTitle;
                renderStaticComponents();
                renderItinerary();
                renderFoodieList();
                renderCoupons();
                setupEventListeners();
                fetchAllWeatherData(tripData.locations, tripData.itinerary).then(weatherData => {
                    appState.weatherByLocation = weatherData;
                    updateWeatherUI(weatherData);
                });
            }

            initialize();
        });
    </script>
</body>
</html>
